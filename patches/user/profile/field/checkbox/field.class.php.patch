diff --git a/user/profile/field/checkbox/field.class.php b/user/profile/field/checkbox/field.class.php
index 09989a4..75c955d 100644
--- a/user/profile/field/checkbox/field.class.php
+++ b/user/profile/field/checkbox/field.class.php
@@ -1,4 +1,4 @@
-<?php // $Id$
+<?php
 
 class profile_field_checkbox extends profile_field_base {
 
@@ -8,11 +8,12 @@ class profile_field_checkbox extends profile_field_base {
      * the corresponding key for the data if it exists
      */
     function profile_field_checkbox($fieldid=0, $userid=0) {
+        global $DB;
         //first call parent constructor
         $this->profile_field_base($fieldid, $userid);
 
         if (!empty($this->field)) {
-            $datafield = get_field('user_info_data', 'data', 'userid', $this->userid, 'fieldid', $this->fieldid);
+            $datafield = $DB->get_field('user_info_data', 'data', array('userid' => $this->userid, 'fieldid' => $this->fieldid));
             if ($datafield !== false) {
                 $this->data = $datafield;
             } else {
@@ -37,6 +38,7 @@ class profile_field_checkbox extends profile_field_base {
      * Display the data for this field
      */
     function display_data() {
+        $options = new stdClass();
         $options->para = false;
         $checked = intval($this->data) === 1 ? 'checked="checked"' : '';
         return '<input disabled="disabled" type="checkbox" name="'.$this->inputname.'" '.$checked.' />';
@@ -44,4 +46,4 @@ class profile_field_checkbox extends profile_field_base {
 
 }
 
-?>
+
