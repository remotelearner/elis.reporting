diff --git a/search/documents/physical_swf.php b/search/documents/physical_swf.php
index 2d8a262..2e027b0 100644
--- a/search/documents/physical_swf.php
+++ b/search/documents/physical_swf.php
@@ -8,6 +8,7 @@
 * @author Valery Fremaux [valery.fremaux@club-internet.fr] > 1.8
 * @date 2008/03/31
 * @license http://www.gnu.org/copyleft/gpl.html GNU Public License
+* @version revised for Moodle 2.0
 *
 * @note : The Adobe SWF Converters library is not GPL, although it can be of free use in some
 * situations. This file is provided for convenience, but should use having a glance at 
@@ -19,13 +20,14 @@
 
 /**
 * @param object $resource
+* @param string $directfile if the resource is given as a direct file path, use it as reference to the file
 * @uses $CFG
 */
 function get_text_for_indexing_swf(&$resource, $directfile = ''){
     global $CFG;
     
     // SECURITY : do not allow non admin execute anything on system !!
-    if (!has_capability('moodle/site:doanything', get_context_instance(CONTEXT_SYSTEM))) return;
+    if (!has_capability('moodle/site:config', get_context_instance(CONTEXT_SYSTEM))) return;
     
     // adds moodle root switch if none was defined
     if (!isset($CFG->block_search_usemoodleroot)){
