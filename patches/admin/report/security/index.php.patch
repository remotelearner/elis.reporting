diff --git a/admin/report/security/index.php b/admin/report/security/index.php
index 2bcddf2..2e8391b 100644
--- a/admin/report/security/index.php
+++ b/admin/report/security/index.php
@@ -1,4 +1,4 @@
-<?php  //$Id$
+<?php
 
 ///////////////////////////////////////////////////////////////////////////
 //                                                                       //
@@ -23,13 +23,15 @@
 //                                                                       //
 ///////////////////////////////////////////////////////////////////////////
 
+define('NO_OUTPUT_BUFFERING', true);
+
 require_once('../../../config.php');
 require_once($CFG->dirroot.'/'.$CFG->admin.'/report/security/lib.php');
 require_once($CFG->libdir.'/adminlib.php');
 
 require_login();
 
-$issue = optional_param('issue', '', PARAM_FILE); // show detailed info about one issue only
+$issue = optional_param('issue', '', PARAM_ALPHANUMEXT); // show detailed info about one issue only
 
 $issues = report_security_get_issue_list();
 
@@ -39,18 +41,16 @@ if (array_search($issue, $issues, true) === false) {
 }
 
 // we may need a bit more memory and this may take a long time to process
-@raise_memory_limit('128M');
+raise_memory_limit(MEMORY_EXTRA);
 @set_time_limit(0);
 
 // Print the header.
-admin_externalpage_setup('reportsecurity');
-admin_externalpage_print_header();
+admin_externalpage_setup('reportsecurity', '', null, '', array('pagelayout'=>'report'));
+echo $OUTPUT->header();
 
-print_heading(get_string('reportsecurity', 'report_security'));
+echo $OUTPUT->heading(get_string('pluginname', 'report_security'));
 
 echo '<div id="timewarning">'.get_string('timewarning', 'report_security').'</div>';
-while(@ob_end_flush());
-@flush();
 
 $strok       = '<span class="statusok">'.get_string('statusok', 'report_security').'</span>';
 $strinfo     = '<span class="statusinfo">'.get_string('statusinfo', 'report_security').'</span>';
@@ -74,11 +74,11 @@ $url = "$CFG->wwwroot/$CFG->admin/report/security/index.php";
 if ($issue and ($result = $issue(true))) {
     report_security_hide_timearning();
 
-    $table = new object();
+    $table = new html_table();
     $table->head  = array($strissue, $strstatus, $strdesc, $strconfig);
     $table->size  = array('30%', '10%', '50%', '10%' );
     $table->align = array('left', 'left', 'left', 'left');
-    $table->width = '90%';
+    $table->attributes = array('class'=>'scurityreporttable generaltable');
     $table->data  = array();
 
     // print detail of one issue only
@@ -88,24 +88,24 @@ if ($issue and ($result = $issue(true))) {
     $row[2] = $result->info;
     $row[3] = is_null($result->link) ? '&nbsp;' : $result->link;
 
-    $CFG->pagepath = "report/security/$issue"; // help link in footer
+    $PAGE->set_docs_path('admin/report/security/' . $issue);
 
     $table->data[] = $row;
 
-    print_table($table);
+    echo html_writer::table($table);
 
-    print_box($result->details, 'generalbox boxwidthnormal boxaligncenter'); // TODO: add proper css
+    echo $OUTPUT->box($result->details, 'generalbox boxwidthnormal boxaligncenter'); // TODO: add proper css
 
-    print_continue($url);
+    echo $OUTPUT->continue_button($url);
 
 } else {
     report_security_hide_timearning();
 
-    $table = new object();
+    $table = new html_table();
     $table->head  = array($strissue, $strstatus, $strdesc);
     $table->size  = array('30%', '10%', '60%' );
     $table->align = array('left', 'left', 'left');
-    $table->width = '90%';
+    $table->attributes = array('class'=>'scurityreporttable generaltable');
     $table->data  = array();
 
     foreach ($issues as $issue) {
@@ -121,7 +121,7 @@ if ($issue and ($result = $issue(true))) {
 
         $table->data[] = $row;
     }
-    print_table($table);
+    echo html_writer::table($table);
 }
 
-print_footer();
\ No newline at end of file
+echo $OUTPUT->footer();
