diff --git a/course/report/log/mod.php b/course/report/log/mod.php
index 970253b..3c278a6 100644
--- a/course/report/log/mod.php
+++ b/course/report/log/mod.php
@@ -1,4 +1,4 @@
-<?php  // $Id$
+<?php
 
     if (!defined('MOODLE_INTERNAL')) {
         die('Direct access to this script is forbidden.');    ///  It must be included from a Moodle page
@@ -8,15 +8,16 @@
     require_once($CFG->dirroot.'/course/report/log/lib.php');
 
     if (has_capability('coursereport/log:view', $context)) {
-        print_heading(get_string('chooselogs') .':');
+        echo $OUTPUT->heading(get_string('chooselogs') .':');
 
         print_log_selector_form($course);
     }
 
     if (has_capability('coursereport/log:viewlive', $context)) {
-        print_heading(get_string('chooselivelogs') .':');
+        echo $OUTPUT->heading(get_string('chooselivelogs') .':');
         echo '<p>';
-        link_to_popup_window('/course/report/log/live.php?id='. $course->id,'livelog', get_string('livelogs'), 500, 800);
+        $link = new moodle_url('/course/report/log/live.php?id='. $course->id);
+        echo $OUTPUT->action_link($link, get_string('livelogs'), new popup_action('click', $link, 'livelog', array('height' => 500, 'width' => 800)));
         echo '</p>';
     }
-?>
\ No newline at end of file
+
