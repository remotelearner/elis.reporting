diff --git a/login/restored_password_form.php b/login/restored_password_form.php
index d883920..3a93fcc 100644
--- a/login/restored_password_form.php
+++ b/login/restored_password_form.php
@@ -1,5 +1,29 @@
 <?php
 
+// This file is part of Moodle - http://moodle.org/
+//
+// Moodle is free software: you can redistribute it and/or modify
+// it under the terms of the GNU General Public License as published by
+// the Free Software Foundation, either version 3 of the License, or
+// (at your option) any later version.
+//
+// Moodle is distributed in the hope that it will be useful,
+// but WITHOUT ANY WARRANTY; without even the implied warranty of
+// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+// GNU General Public License for more details.
+//
+// You should have received a copy of the GNU General Public License
+// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.
+
+/**
+ * Magic that deals restored users without passwords.
+ *
+ * @package    core
+ * @subpackage auth
+ * @copyright  2010 onwards Eloy Lafuente (stronk7) {@link http://stronk7.com}
+ * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
+ */
+
 // This is one "supplanter" form that generates
 // one correct forgot_password.php request in
 // order to get the mailout for 'restored' users
@@ -11,16 +35,14 @@
 // part of each plugin, but now now. See MDL-20846
 // for the rationale for this implementation.
 
-if (!defined('MOODLE_INTERNAL')) {
-    die('Direct access to this script is forbidden.');    ///  It must be included from a Moodle page
-}
+defined('MOODLE_INTERNAL') || die();
 
 require_once $CFG->libdir.'/formslib.php';
 
 class login_forgot_password_form extends moodleform {
 
     function definition() {
-        $mform    =& $this->_form;
+        $mform    = $this->_form;
 
         $username = $this->_customdata['username'];
 
@@ -31,5 +53,3 @@ class login_forgot_password_form extends moodleform {
     }
 
 }
-
-?>
