diff --git a/mod/assignment/settings.php b/mod/assignment/settings.php
index 745ef72..05fa52c 100644
--- a/mod/assignment/settings.php
+++ b/mod/assignment/settings.php
@@ -1,16 +1,20 @@
-<?php  //$Id$
+<?php
 
-require_once($CFG->dirroot.'/mod/assignment/lib.php');
+defined('MOODLE_INTERNAL') || die;
 
-$settings->add(new admin_setting_configselect('assignment_maxbytes', get_string('maximumsize', 'assignment'),
+if ($ADMIN->fulltree) {
+    require_once($CFG->dirroot.'/mod/assignment/lib.php');
+
+    if (isset($CFG->maxbytes)) {
+        $settings->add(new admin_setting_configselect('assignment_maxbytes', get_string('maximumsize', 'assignment'),
                    get_string('configmaxbytes', 'assignment'), 1048576, get_max_upload_sizes($CFG->maxbytes)));
+    }
 
-$options = array(ASSIGNMENT_COUNT_WORDS   => trim(get_string('numwords', '')),
-                 ASSIGNMENT_COUNT_LETTERS => trim(get_string('numletters', '')));
-$settings->add(new admin_setting_configselect('assignment_itemstocount', get_string('itemstocount', 'assignment'),
+    $options = array(ASSIGNMENT_COUNT_WORDS   => trim(get_string('numwords', '', '?')),
+                     ASSIGNMENT_COUNT_LETTERS => trim(get_string('numletters', '', '?')));
+    $settings->add(new admin_setting_configselect('assignment_itemstocount', get_string('itemstocount', 'assignment'),
                    get_string('configitemstocount', 'assignment'), ASSIGNMENT_COUNT_WORDS, $options));
 
-$settings->add(new admin_setting_configcheckbox('assignment_showrecentsubmissions', get_string('showrecentsubmissions', 'assignment'),
+    $settings->add(new admin_setting_configcheckbox('assignment_showrecentsubmissions', get_string('showrecentsubmissions', 'assignment'),
                    get_string('configshowrecentsubmissions', 'assignment'), 1));
-
-?>
+}
